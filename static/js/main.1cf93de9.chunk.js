(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{28:function(e,t,c){e.exports={available:"Seat_available__gMd6U",selected:"Seat_selected__3tu3N"}},35:function(e,t,c){},48:function(e,t,c){"use strict";c.r(t);var n=c(1),r=c.n(n),a=c(22),s=c.n(a),i=(c(35),c(16)),l=c(2),o=c(8),d=c(23),u=c(4),j=c.n(u),b=c(0);function f(e){var t=e.style,c=e.className,n=e.children,r=e.elevation,a=void 0===r?1:r,s=e.onClick,i=j()("paper-default",c,{"shadow-sm":1===a,shadow:2===a,"shadow-md":3===a,"shadow-lg":4===a,"shadow-xl":5===a,"shadow-2xl":6===a});return Object(b.jsx)("div",{style:t,className:i,onClick:s,children:n})}var m=["children","className","style"];function v(e){var t=e.children,c=e.className,n=e.style,r=Object(d.a)(e,m),a=j()("appBar-default",c);return Object(b.jsx)(f,Object(o.a)(Object(o.a)({style:n,className:a},r),{},{children:t}))}var x=["className","style","imageUrl","children"];function h(e){var t=e.className,c=e.style,n=e.imageUrl,r=e.children,a=Object(d.a)(e,x),s=j()(t);return Object(b.jsxs)(f,Object(o.a)(Object(o.a)({className:s,style:c},a),{},{children:[n&&Object(b.jsx)("div",{className:"h-full w-48 flex-none bg-cover rounded-t lg:rounded-t-none lg:rounded-l text-center overflow-hidden",style:{backgroundImage:"url('".concat(n,"')")}}),r]}))}function O(e){return("development"===Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_ENV?"":"/movie-ticketing")+e}function p(e){var t=e.className,c=e.style,n=e.movie,r=j()("movieCard-default",t),a=Object(l.f)();return Object(b.jsx)(h,{className:r,style:c,onClick:function(e){a.push(O("/movie/".concat(n.id)))},imageUrl:n.poster,children:Object(b.jsxs)("div",{className:"flex flex-col justify-between p-2 h-full",children:[Object(b.jsxs)("div",{className:"flex flex-col",children:[Object(b.jsx)("div",{className:"text-gray-900 font-bold text-xl mb-2",children:n.title}),Object(b.jsx)("p",{className:"text-gray-700 text-lg text-base",children:n.description}),Object(b.jsxs)("p",{className:"text-gray-500 text-sm text-base",children:["Cast: ",n.cast]}),Object(b.jsxs)("p",{className:"text-gray-500 text-sm text-base",children:["Director: ",n.director]})]}),Object(b.jsxs)("div",{className:"text-right",children:[" ",n.runtime," mins "]})]})})}var g=c(3),y=c(19),N=c(5),w=c.n(N),S=c(11),k=c(10),C="development"===Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_ENV?{protocol:"http",host:"localhost:8080"}:{protocol:"https",host:"murmuring-wildwood-07967.herokuapp.com"},T=Object(o.a)({},Object(o.a)(Object(o.a)({},{path:"/api/v1"}),C));function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.startsWith("/")&&(e=e.slice(1));var c="".concat(T.protocol,"://").concat(T.host).concat(T.path),n="".concat(c,"/").concat(e);return fetch(n,t).then(function(){var e=Object(S.a)(w.a.mark((function e(t){var c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=4;break}return e.abrupt("return",t.json());case 4:return e.next=6,t.json();case 6:return c=e.sent,e.abrupt("return",Promise.reject(c.message));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){return e}))}function E(){return I.apply(this,arguments)}function I(){return(I=Object(S.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"movie/all",e.abrupt("return",_("movie/all"));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return _("movie/".concat(e))}function R(e,t,c,n){return _("movie/".concat(e,"/slot/").concat(t,"/").concat(c),{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}})}function A(e){return _("ticket/".concat(e))}var D=Object(k.b)("movieService/fetchMovies",Object(S.a)(w.a.mark((function e(){var t;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E();case 3:return t=e.sent,e.abrupt("return",t);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))),W=Object(k.b)("movieService/fetchMovie",function(){var e=Object(S.a)(w.a.mark((function e(t,c){var n,r,a,s,i;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.movieId,r=t.refresh,a=void 0!==r&&r,s=c.getState,e.prev=2,H(n)(s())&&!a){e.next=11;break}return e.next=7,P(n);case 7:return i=e.sent,e.abrupt("return",i);case 11:return e.abrupt("return",null);case 12:e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(2),e.abrupt("return",Promise.reject(e.t0));case 17:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t,c){return e.apply(this,arguments)}}()),U=Object(k.c)({name:"movieService",initialState:{movies:[],status:"idle"},reducers:{updateSeatAvailability:function(e,t){var c,n=t.payload,r=Object(y.a)(n);try{var a=function(){var t=c.value;e.movies.find((function(e){return e.id===t.movie.id})).slots.find((function(e){return e.id===t.slot.id})).seats.find((function(e){return e.id===t.seat.id})).availability=t.seat.availability};for(r.s();!(c=r.n()).done;)a()}catch(s){r.e(s)}finally{r.f()}}},extraReducers:function(e){e.addCase(D.pending,(function(e){e.status="loading"})).addCase(D.fulfilled,(function(e,t){e.status="idle",e.movies=t.payload})).addCase(D.rejected,(function(e,t){e.status="idle"})).addCase(W.pending,(function(e){e.status="loading"})).addCase(W.fulfilled,(function(e,t){if(e.status="idle",t.payload){var c=t.payload,n=e.movies.findIndex((function(e){return e.id===c.id}));-1===n?e.movies.push(t.payload):(e.movies.splice(n,1),e.movies.push(c))}})).addCase(W.rejected,(function(e,t){e.status="idle"}))}}),B=U.actions.updateSeatAvailability,F=function(e){return e.movieService.movies},H=function(e){return function(t){return t.movieService.movies.find((function(t){return t.id===e}))}},K=function(e){return e.movieService.status},M=U.reducer,J=Object(k.c)({name:"noticeService",initialState:{error:null,warning:null,info:null},reducers:{error:function(e,t){e.error=t.payload},dismissError:function(e){e.error=null}}}),L=J.actions,V=L.error,G=L.dismissError,$=function(e){return e.noticeService.error},q=J.reducer;function z(e){var t=e.className,c=e.style,r=Object(g.c)(F),a=Object(g.c)(K),s=Object(g.b)(),i=j()("grid gap-4 grid-cols-1 lg:grid-cols-2",t);return Object(n.useEffect)((function(){s(D()).unwrap().catch((function(e){s(V(e))}))}),[s]),Object(b.jsxs)("div",{className:i,style:c,children:["loading"===a&&Object(b.jsx)("div",{children:"loading..."}),"loading"!==a&&r.map((function(e){return Object(b.jsx)(p,{movie:e},e.id)}))]})}var Q=c(13),X=(c(47),c(21)),Y=sessionStorage.getItem("user"),Z={details:Y?JSON.parse(Y):null,tickets:[],status:"idle",loaded:!1},ee=Object(k.b)("userService/bookTickets",function(){var e=Object(S.a)(w.a.mark((function e(t,c){var n,r,a,s,i;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.movieId,r=t.slotId,a=t.userId,s=t.seatIds,c.dispatch,e.prev=2,e.next=5,R(n,r,a,s);case 5:return i=e.sent,e.abrupt("return",i);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",Promise.reject(e.t0));case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,c){return e.apply(this,arguments)}}()),te=Object(k.b)("userService/getTickets",function(){var e=Object(S.a)(w.a.mark((function e(t,c){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.dispatch,e.prev=1,e.next=4,A(t);case 4:return n=e.sent,e.abrupt("return",n);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",Promise.reject(e.t0));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,c){return e.apply(this,arguments)}}()),ce=Object(k.c)({name:"userService",initialState:Z,reducers:{signIn:function(e){var t={id:"abc"};sessionStorage.setItem("user",JSON.stringify(t)),e.details=t},signOut:function(e){sessionStorage.clear(),e.details=null},addTickets:function(e,t){var c,n=t.payload,r=Object(y.a)(n);try{for(r.s();!(c=r.n()).done;){var a=c.value;e.tickets.push(a)}}catch(s){r.e(s)}finally{r.f()}}},extraReducers:function(e){e.addCase(ee.pending,(function(e){e.status="loading"})).addCase(ee.fulfilled,(function(e,t){var c;e.status="idle",(c=e.tickets).push.apply(c,Object(X.a)(t.payload))})).addCase(te.pending,(function(e){e.status="loading"})).addCase(te.fulfilled,(function(e,t){e.status="idle",e.loaded=!0;var c,n=t.payload,r=Object(y.a)(n);try{var a=function(){var t=c.value;e.tickets.find((function(e){return e.id===t.id}))||e.tickets.push(t)};for(r.s();!(c=r.n()).done;)a()}catch(s){r.e(s)}finally{r.f()}}))}}),ne=ce.actions,re=ne.signIn,ae=ne.signOut,se=(ne.addTickets,function(e){return e.user.details}),ie=function(e){return e.user.tickets},le=function(e){return e.user.status},oe=function(e){return e.user.loaded},de=ce.reducer,ue=function(){var e=Object(l.g)().pathname,t=Object(l.f)(),c=Object(g.b)(),r=Object(n.useState)(!1),a=Object(Q.a)(r,2),s=a[0],i=a[1],o=j()("absolute w-40 bg-white right-0 shadow-md p-2 group-hover:block",{hidden:!s});return Object(b.jsxs)("div",{className:"group relative",children:[Object(b.jsxs)("button",{className:"flex items-center",onClick:function(){i(!s)},children:[Object(b.jsx)("span",{className:"hidden md:inline-block",children:" Welcome back! "}),Object(b.jsx)("div",{className:"rounded-full h-10 w-10 flex items-center justify-center bg-blue-200 ml-2",children:Object(b.jsx)("box-icon",{name:"user",color:"white"})})]}),Object(b.jsxs)("ul",{className:o,children:[Object(b.jsx)("li",{className:"px-3 py-2",children:Object(b.jsxs)("button",{className:"flex items-center justify-between",onClick:function(){t.push(O("/tickets"))},children:[Object(b.jsx)("box-icon",{name:"barcode"}),Object(b.jsx)("span",{className:"ml-2",children:"My Tickets"})]})}),Object(b.jsx)("li",{className:"px-3 py-2 hower:bg-gray-100",children:Object(b.jsxs)("button",{className:"flex items-center justify-between ",onClick:function(){c(ae()),"/tickets"===e&&t.push("/")},children:[Object(b.jsx)("box-icon",{name:"log-out"}),Object(b.jsx)("span",{className:"ml-2 flex-grow",children:"Sign Out"})]})})]})]})},je=function(){var e=Object(g.b)();return Object(b.jsx)("button",{className:"flex items-center",onClick:function(){e(re())},children:Object(b.jsx)("box-icon",{name:"log-in"})})};function be(e){var t=e.className,c=e.style,n=Object(g.c)(se),r=j()(t);return Object(b.jsx)("div",{className:r,style:c,children:n?Object(b.jsx)(ue,{}):Object(b.jsx)(je,{})})}var fe=c(17),me=c(28),ve=c.n(me);function xe(e){var t,c=e.children,n=e.selected,r=e.disabled,a=e.onToggle,s=j()("h-12 md:h-16 lg:h-24 flex justify-center items-center rounded-md",r?"bg-gray-300 cursor-default":"bg-white cursor-pointer",(t={},Object(fe.a)(t,ve.a.selected,n&&!r),Object(fe.a)(t,ve.a.available,!n),t));return Object(b.jsx)("div",{className:s,onClick:function(e){return r?e.stopPropagation:a(e)},children:c})}function he(e){var t=Object(l.h)().movieId,c=Object(g.b)(),r=Object(g.c)(se),a=Object(g.c)(H(t)),s=Object(g.c)(K),i=Object(n.useState)([]),o=Object(Q.a)(i,2),d=o[0],u=o[1],m=Object(n.useState)(""),v=Object(Q.a)(m,2),x=v[0],h=v[1],O=Object(n.useState)(""),y=Object(Q.a)(O,2),N=y[0],w=y[1],S=Object(n.useState)([]),k=Object(Q.a)(S,2),C=k[0],T=k[1],_=Object(n.useState)([]),E=Object(Q.a)(_,2),I=E[0],P=E[1],R=Object(n.useState)(0),A=Object(Q.a)(R,2),D=A[0],U=A[1],F=a?a.slots.reduce((function(e,t){var c=t.date;return c in e||(e[c]={}),e[c][t.endTime]=t,e}),{}):{};Object(n.useEffect)((function(){c(W({movieId:t})).unwrap().catch((function(e){return c(V(e))}));var e=Object.keys(F);if(e.length){var n=e[0];h(n);var r=F[n],s=Object.keys(r).map((function(e){return{id:r[e].id,time:e}}));if(T(s),s.length){var i=s[0].id;w(i);var l=a.slots.find((function(e){return e.id===i})).seats;P(l)}}}),[a]);var M=j()("mt-3 border rounded  text-white p-2 text-lg font-medium",d.length&&r?"bg-green-400":"bg-gray-300"),J=j()("text-right text-blue-500",{hidden:r}),L=j()("text-md","font-medium");return Object(b.jsxs)("div",{children:[!a&&"loading"===s&&Object(b.jsx)("div",{children:" loading... "}),a&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"flex",children:[Object(b.jsx)(p,{className:"hidden md:flex flex-grow",movie:a}),Object(b.jsxs)(f,{className:"flex-col p-5 md:w-96 w-full",elevation:1,children:[Object(b.jsx)("div",{className:"w-full mb-2",children:Object(b.jsx)("span",{className:"text-gray-900 font-bold text-xl",children:a.title})}),Object(b.jsxs)("div",{className:"flex flex-col w-full mb-2",children:[Object(b.jsx)("span",{className:L,children:"DATE:"}),Object(b.jsxs)("select",{onChange:function(e){return h(e.target.value)},value:x,children:[Object(b.jsx)("option",{value:"",disabled:!0,children:"select a date"}),Object.keys(F).map((function(e){return Object(b.jsx)("option",{value:e,children:e},e)}))]})]}),Object(b.jsxs)("div",{className:"flex flex-col w-full mb-2",children:[Object(b.jsx)("span",{className:L,children:"TIME:"}),Object(b.jsxs)("select",{onChange:function(e){return w(e.target.value)},value:N,children:[Object(b.jsx)("option",{value:"",disabled:!0,children:"select a time"}),C.map((function(e){return Object(b.jsx)("option",{value:e.id,children:e.time},e.id)}))]})]}),Object(b.jsxs)("div",{className:"flex flex-row w-full mb-2 justify-between",children:[Object(b.jsxs)("div",{className:L,children:[" ",d.length," tickets"]}),Object(b.jsxs)("div",{className:L,children:[" SGD ",D]})]}),Object(b.jsxs)("div",{className:"flex flex-col w-full",children:[Object(b.jsx)("button",{className:M,onClick:function(){var e={movieId:t,slotId:N,userId:r.id,seatIds:d};c(ee(e)).unwrap().then((function(e){c(B(e))})).catch((function(e){c(V(e)),c(W({movieId:t,refresh:!0}))})).finally((function(){u([]),U(0)}))},disabled:!d.length||!r,children:"Book Now"}),Object(b.jsx)("div",{className:J,children:"Please login to proceed."})]})]})]}),Object(b.jsx)("div",{className:"flex justify-center border my-2 bg-white",children:" screen"}),Object(b.jsx)("div",{className:"grid grid-cols-8 gap-1 md:gap-2 lg:gap-4",children:I.map((function(e){return Object(b.jsx)(xe,{onToggle:function(t){return function(e,t){var c=t.id,n=d.indexOf(c);-1===n?(u([].concat(Object(X.a)(d),[c])),U(D+t.price)):(d.splice(n,1),u(Object(X.a)(d)),U(D-t.price))}(0,e)},selected:-1!==d.indexOf(e.id),disabled:!e.availability,children:e.number},e.id)}))})]})]})}function Oe(e){var t=e.className,c=e.style,r=Object(g.b)(),a=Object(g.c)(ie),s=Object(g.c)(se),i=Object(g.c)(le),l=Object(g.c)(oe);Object(n.useEffect)((function(){!l&&s&&(r(G()),r(te(s.id))),s||r(V({message:"Please login to view tickets"}))}),[s,r]);var o=j()("grid gap-4 grid-cols-1 lg:grid-cols-3 md:grid-cols-2",t);return Object(b.jsxs)("div",{className:o,style:c,children:["loading"===i&&Object(b.jsx)("div",{children:"loading..."}),"idle"===i&&s&&!a.length&&Object(b.jsx)("div",{children:"No ticket available"}),"idle"===i&&a.map((function(e){return Object(b.jsx)(h,{elevation:2,imageUrl:e.movie.poster,children:Object(b.jsxs)("div",{className:"flex flex-col p-2 w-full",children:[Object(b.jsx)("div",{className:"font-bold text-lg",children:e.movie.title}),Object(b.jsx)("div",{className:"text-gray-700 text-lg",children:e.slot.date}),Object(b.jsx)("div",{className:"mb-5 text-gray-700 text-lg",children:e.slot.startTime}),Object(b.jsxs)("div",{className:"text-right font-bold text-xl text-blue-700",children:["Hall ",e.slot.hall," Seat ",e.seat.number]})]})},e.id)}))]})}function pe(e){var t=Object(g.c)($),c=Object(g.b)(),n=j()("flex justify-center items-center","rounded","bg-red-100","p-3","text-red-500","my-2");return Object(b.jsx)(b.Fragment,{children:t&&Object(b.jsxs)("div",{className:n,children:[Object(b.jsx)("span",{className:"flex-grow",children:t.message}),Object(b.jsx)("button",{className:"rounded-full h-6 w-6 bg-white flex justify-center items-center font-bold text-xl",onClick:function(){c(G())},children:Object(b.jsx)("span",{children:"\xd7"})})]})})}var ge=function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("span",{className:"font-bold text-3xl text-blue-700",children:"OCB"}),Object(b.jsx)("span",{className:"text-3xl text-blue-500",children:"Cinema"})]})};var ye=function(){return Object(b.jsxs)("div",{className:"bg-gray-100 h-screen",children:[Object(b.jsxs)(v,{elevation:3,children:[Object(b.jsx)("div",{className:"flex-grow",children:Object(b.jsx)(i.b,{to:O("/"),children:Object(b.jsx)(ge,{})})}),Object(b.jsx)(be,{})]}),Object(b.jsxs)("div",{className:"p-3",children:[Object(b.jsx)(pe,{}),Object(b.jsxs)(l.c,{children:[Object(b.jsx)(l.a,{path:O("/movie/:movieId"),children:Object(b.jsx)(he,{})}),Object(b.jsx)(l.a,{path:O("/tickets"),children:Object(b.jsx)(Oe,{})}),Object(b.jsx)(l.a,{path:O("/"),children:Object(b.jsx)(z,{})})]})]})]})},Ne=Object(k.a)({reducer:{user:de,movieService:M,noticeService:q}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(g.a,{store:Ne,children:Object(b.jsx)(i.a,{children:Object(b.jsx)(ye,{})})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[48,1,2]]]);
//# sourceMappingURL=main.1cf93de9.chunk.js.map