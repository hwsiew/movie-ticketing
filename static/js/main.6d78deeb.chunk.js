(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{28:function(e,t,c){e.exports={available:"Seat_available__gMd6U",selected:"Seat_selected__3tu3N"}},35:function(e,t,c){},48:function(e,t,c){"use strict";c.r(t);var n=c(1),r=c.n(n),a=c(22),s=c.n(a),i=(c(35),c(16)),l=c(2),o=c(8),d=c(23),u=c(4),j=c.n(u),b=c(0);function f(e){var t=e.style,c=e.className,n=e.children,r=e.elevation,a=void 0===r?1:r,s=e.onClick,i=j()("paper-default",c,{"shadow-sm":1===a,shadow:2===a,"shadow-md":3===a,"shadow-lg":4===a,"shadow-xl":5===a,"shadow-2xl":6===a});return Object(b.jsx)("div",{style:t,className:i,onClick:s,children:n})}var m=["children","className","style"];function v(e){var t=e.children,c=e.className,n=e.style,r=Object(d.a)(e,m),a=j()("appBar-default",c);return Object(b.jsx)(f,Object(o.a)(Object(o.a)({style:n,className:a},r),{},{children:t}))}var x=["className","style","imageUrl","children"];function h(e){var t=e.className,c=e.style,n=e.imageUrl,r=e.children,a=Object(d.a)(e,x),s=j()(t);return Object(b.jsxs)(f,Object(o.a)(Object(o.a)({className:s,style:c},a),{},{children:[n&&Object(b.jsx)("div",{className:"h-full w-48 flex-none bg-cover rounded-t lg:rounded-t-none lg:rounded-l text-center overflow-hidden",style:{backgroundImage:"url('".concat(n,"')")}}),r]}))}function O(e){var t=e.className,c=e.style,n=e.movie,r=j()("movieCard-default",t),a=Object(l.f)();return Object(b.jsx)(h,{className:r,style:c,onClick:function(e){a.push("/movie/".concat(n.id))},imageUrl:n.poster,children:Object(b.jsxs)("div",{className:"flex flex-col justify-between p-2 h-full",children:[Object(b.jsxs)("div",{className:"flex flex-col",children:[Object(b.jsx)("div",{className:"text-gray-900 font-bold text-xl mb-2",children:n.title}),Object(b.jsx)("p",{className:"text-gray-700 text-lg text-base",children:n.description}),Object(b.jsxs)("p",{className:"text-gray-500 text-sm text-base",children:["Cast: ",n.cast]}),Object(b.jsxs)("p",{className:"text-gray-500 text-sm text-base",children:["Director: ",n.director]})]}),Object(b.jsxs)("div",{className:"text-right",children:[" ",n.runtime," mins "]})]})})}var p=c(3),g=c(19),y=c(5),N=c.n(y),w=c(11),k=c(10),S="development"===Object({NODE_ENV:"production",PUBLIC_URL:"/movie-ticketing",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_ENV?{protocol:"http",host:"localhost:8080"}:{protocol:"https",host:"murmuring-wildwood-07967.herokuapp.com"},C=Object(o.a)({},Object(o.a)(Object(o.a)({},{path:"/api/v1"}),S));function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.startsWith("/")&&(e=e.slice(1));var c="".concat(C.protocol,"://").concat(C.host).concat(C.path),n="".concat(c,"/").concat(e);return fetch(n,t).then(function(){var e=Object(w.a)(N.a.mark((function e(t){var c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=4;break}return e.abrupt("return",t.json());case 4:return e.next=6,t.json();case 6:return c=e.sent,e.abrupt("return",Promise.reject(c.message));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){return e}))}function T(){return E.apply(this,arguments)}function E(){return(E=Object(w.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"movie/all",e.abrupt("return",I("movie/all"));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){return I("movie/".concat(e))}function P(e,t,c,n){return I("movie/".concat(e,"/slot/").concat(t,"/").concat(c),{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}})}function A(e){return I("ticket/".concat(e))}var D=Object(k.b)("movieService/fetchMovies",Object(w.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T();case 3:return t=e.sent,e.abrupt("return",t);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))),R=Object(k.b)("movieService/fetchMovie",function(){var e=Object(w.a)(N.a.mark((function e(t,c){var n,r,a,s,i;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.movieId,r=t.refresh,a=void 0!==r&&r,s=c.getState,e.prev=2,M(n)(s())&&!a){e.next=11;break}return e.next=7,_(n);case 7:return i=e.sent,e.abrupt("return",i);case 11:return e.abrupt("return",null);case 12:e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(2),e.abrupt("return",Promise.reject(e.t0));case 17:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t,c){return e.apply(this,arguments)}}()),U=Object(k.c)({name:"movieService",initialState:{movies:[],status:"idle"},reducers:{updateSeatAvailability:function(e,t){var c,n=t.payload,r=Object(g.a)(n);try{var a=function(){var t=c.value;e.movies.find((function(e){return e.id===t.movie.id})).slots.find((function(e){return e.id===t.slot.id})).seats.find((function(e){return e.id===t.seat.id})).availability=t.seat.availability};for(r.s();!(c=r.n()).done;)a()}catch(s){r.e(s)}finally{r.f()}}},extraReducers:function(e){e.addCase(D.pending,(function(e){e.status="loading"})).addCase(D.fulfilled,(function(e,t){e.status="idle",e.movies=t.payload})).addCase(D.rejected,(function(e,t){e.status="idle"})).addCase(R.pending,(function(e){e.status="loading"})).addCase(R.fulfilled,(function(e,t){if(e.status="idle",t.payload){var c=t.payload,n=e.movies.findIndex((function(e){return e.id===c.id}));-1===n?e.movies.push(t.payload):(e.movies.splice(n,1),e.movies.push(c))}})).addCase(R.rejected,(function(e,t){e.status="idle"}))}}),W=U.actions.updateSeatAvailability,B=function(e){return e.movieService.movies},M=function(e){return function(t){return t.movieService.movies.find((function(t){return t.id===e}))}},F=function(e){return e.movieService.status},J=U.reducer,H=Object(k.c)({name:"noticeService",initialState:{error:null,warning:null,info:null},reducers:{error:function(e,t){e.error=t.payload},dismissError:function(e){e.error=null}}}),K=H.actions,L=K.error,V=K.dismissError,G=function(e){return e.noticeService.error},$=H.reducer;function q(e){var t=e.className,c=e.style,r=Object(p.c)(B),a=Object(p.c)(F),s=Object(p.b)(),i=j()("grid gap-4 grid-cols-1 lg:grid-cols-2",t);return Object(n.useEffect)((function(){s(D()).unwrap().catch((function(e){s(L(e))}))}),[s]),Object(b.jsxs)("div",{className:i,style:c,children:["loading"===a&&Object(b.jsx)("div",{children:"loading..."}),"loading"!==a&&r.map((function(e){return Object(b.jsx)(O,{movie:e},e.id)}))]})}var z=c(13),Q=(c(47),c(21)),X=sessionStorage.getItem("user"),Y={details:X?JSON.parse(X):null,tickets:[],status:"idle",loaded:!1},Z=Object(k.b)("userService/bookTickets",function(){var e=Object(w.a)(N.a.mark((function e(t,c){var n,r,a,s,i;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.movieId,r=t.slotId,a=t.userId,s=t.seatIds,c.dispatch,e.prev=2,e.next=5,P(n,r,a,s);case 5:return i=e.sent,e.abrupt("return",i);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",Promise.reject(e.t0));case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,c){return e.apply(this,arguments)}}()),ee=Object(k.b)("userService/getTickets",function(){var e=Object(w.a)(N.a.mark((function e(t,c){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.dispatch,e.prev=1,e.next=4,A(t);case 4:return n=e.sent,e.abrupt("return",n);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",Promise.reject(e.t0));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,c){return e.apply(this,arguments)}}()),te=Object(k.c)({name:"userService",initialState:Y,reducers:{signIn:function(e){var t={id:"abc"};sessionStorage.setItem("user",JSON.stringify(t)),e.details=t},signOut:function(e){sessionStorage.clear(),e.details=null},addTickets:function(e,t){var c,n=t.payload,r=Object(g.a)(n);try{for(r.s();!(c=r.n()).done;){var a=c.value;e.tickets.push(a)}}catch(s){r.e(s)}finally{r.f()}}},extraReducers:function(e){e.addCase(Z.pending,(function(e){e.status="loading"})).addCase(Z.fulfilled,(function(e,t){var c;e.status="idle",(c=e.tickets).push.apply(c,Object(Q.a)(t.payload))})).addCase(ee.pending,(function(e){e.status="loading"})).addCase(ee.fulfilled,(function(e,t){e.status="idle",e.loaded=!0;var c,n=t.payload,r=Object(g.a)(n);try{var a=function(){var t=c.value;e.tickets.find((function(e){return e.id===t.id}))||e.tickets.push(t)};for(r.s();!(c=r.n()).done;)a()}catch(s){r.e(s)}finally{r.f()}}))}}),ce=te.actions,ne=ce.signIn,re=ce.signOut,ae=(ce.addTickets,function(e){return e.user.details}),se=function(e){return e.user.tickets},ie=function(e){return e.user.status},le=function(e){return e.user.loaded},oe=te.reducer,de=function(){var e=Object(l.g)().pathname,t=Object(l.f)(),c=Object(p.b)(),r=Object(n.useState)(!1),a=Object(z.a)(r,2),s=a[0],i=a[1],o=j()("absolute w-40 bg-white right-0 shadow-md p-2 group-hover:block",{hidden:!s});return Object(b.jsxs)("div",{className:"group relative",children:[Object(b.jsxs)("button",{className:"flex items-center",onClick:function(){i(!s)},children:[Object(b.jsx)("span",{className:"hidden md:inline-block",children:" Welcome back! "}),Object(b.jsx)("div",{className:"rounded-full h-10 w-10 flex items-center justify-center bg-blue-200 ml-2",children:Object(b.jsx)("box-icon",{name:"user",color:"white"})})]}),Object(b.jsxs)("ul",{className:o,children:[Object(b.jsx)("li",{className:"px-3 py-2",children:Object(b.jsxs)("button",{className:"flex items-center justify-between",onClick:function(){t.push("/tickets")},children:[Object(b.jsx)("box-icon",{name:"barcode"}),Object(b.jsx)("span",{className:"ml-2",children:"My Tickets"})]})}),Object(b.jsx)("li",{className:"px-3 py-2 hower:bg-gray-100",children:Object(b.jsxs)("button",{className:"flex items-center justify-between ",onClick:function(){c(re()),"/tickets"===e&&t.push("/")},children:[Object(b.jsx)("box-icon",{name:"log-out"}),Object(b.jsx)("span",{className:"ml-2 flex-grow",children:"Sign Out"})]})})]})]})},ue=function(){var e=Object(p.b)();return Object(b.jsx)("button",{className:"flex items-center",onClick:function(){e(ne())},children:Object(b.jsx)("box-icon",{name:"log-in"})})};function je(e){var t=e.className,c=e.style,n=Object(p.c)(ae),r=j()(t);return Object(b.jsx)("div",{className:r,style:c,children:n?Object(b.jsx)(de,{}):Object(b.jsx)(ue,{})})}var be=c(17),fe=c(28),me=c.n(fe);function ve(e){var t,c=e.children,n=e.selected,r=e.disabled,a=e.onToggle,s=j()("h-12 md:h-16 lg:h-24 flex justify-center items-center rounded-md",r?"bg-gray-300 cursor-default":"bg-white cursor-pointer",(t={},Object(be.a)(t,me.a.selected,n&&!r),Object(be.a)(t,me.a.available,!n),t));return Object(b.jsx)("div",{className:s,onClick:function(e){return r?e.stopPropagation:a(e)},children:c})}function xe(e){var t=Object(l.h)().movieId,c=Object(p.b)(),r=Object(p.c)(ae),a=Object(p.c)(M(t)),s=Object(p.c)(F),i=Object(n.useState)([]),o=Object(z.a)(i,2),d=o[0],u=o[1],m=Object(n.useState)(""),v=Object(z.a)(m,2),x=v[0],h=v[1],g=Object(n.useState)(""),y=Object(z.a)(g,2),N=y[0],w=y[1],k=Object(n.useState)([]),S=Object(z.a)(k,2),C=S[0],I=S[1],T=Object(n.useState)([]),E=Object(z.a)(T,2),_=E[0],P=E[1],A=Object(n.useState)(0),D=Object(z.a)(A,2),U=D[0],B=D[1],J=a?a.slots.reduce((function(e,t){var c=t.date;return c in e||(e[c]={}),e[c][t.endTime]=t,e}),{}):{};Object(n.useEffect)((function(){c(R({movieId:t})).unwrap().catch((function(e){return c(L(e))}));var e=Object.keys(J);if(e.length){var n=e[0];h(n);var r=J[n],s=Object.keys(r).map((function(e){return{id:r[e].id,time:e}}));if(I(s),s.length){var i=s[0].id;w(i);var l=a.slots.find((function(e){return e.id===i})).seats;P(l)}}}),[a]);var H=j()("mt-3 border rounded  text-white p-2 text-lg font-medium",d.length&&r?"bg-green-400":"bg-gray-300"),K=j()("text-right text-blue-500",{hidden:r}),V=j()("text-md","font-medium");return Object(b.jsxs)("div",{children:[!a&&"loading"===s&&Object(b.jsx)("div",{children:" loading... "}),a&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"flex",children:[Object(b.jsx)(O,{className:"hidden md:flex flex-grow",movie:a}),Object(b.jsxs)(f,{className:"flex-col p-5 md:w-96 w-full",elevation:1,children:[Object(b.jsx)("div",{className:"w-full mb-2",children:Object(b.jsx)("span",{className:"text-gray-900 font-bold text-xl",children:a.title})}),Object(b.jsxs)("div",{className:"flex flex-col w-full mb-2",children:[Object(b.jsx)("span",{className:V,children:"DATE:"}),Object(b.jsxs)("select",{onChange:function(e){return h(e.target.value)},value:x,children:[Object(b.jsx)("option",{value:"",disabled:!0,children:"select a date"}),Object.keys(J).map((function(e){return Object(b.jsx)("option",{value:e,children:e},e)}))]})]}),Object(b.jsxs)("div",{className:"flex flex-col w-full mb-2",children:[Object(b.jsx)("span",{className:V,children:"TIME:"}),Object(b.jsxs)("select",{onChange:function(e){return w(e.target.value)},value:N,children:[Object(b.jsx)("option",{value:"",disabled:!0,children:"select a time"}),C.map((function(e){return Object(b.jsx)("option",{value:e.id,children:e.time},e.id)}))]})]}),Object(b.jsxs)("div",{className:"flex flex-row w-full mb-2 justify-between",children:[Object(b.jsxs)("div",{className:V,children:[" ",d.length," tickets"]}),Object(b.jsxs)("div",{className:V,children:[" SGD ",U]})]}),Object(b.jsxs)("div",{className:"flex flex-col w-full",children:[Object(b.jsx)("button",{className:H,onClick:function(){var e={movieId:t,slotId:N,userId:r.id,seatIds:d};c(Z(e)).unwrap().then((function(e){c(W(e))})).catch((function(e){c(L(e)),c(R({movieId:t,refresh:!0}))})).finally((function(){u([]),B(0)}))},disabled:!d.length||!r,children:"Book Now"}),Object(b.jsx)("div",{className:K,children:"Please login to proceed."})]})]})]}),Object(b.jsx)("div",{className:"flex justify-center border my-2 bg-white",children:" screen"}),Object(b.jsx)("div",{className:"grid grid-cols-8 gap-1 md:gap-2 lg:gap-4",children:_.map((function(e){return Object(b.jsx)(ve,{onToggle:function(t){return function(e,t){var c=t.id,n=d.indexOf(c);-1===n?(u([].concat(Object(Q.a)(d),[c])),B(U+t.price)):(d.splice(n,1),u(Object(Q.a)(d)),B(U-t.price))}(0,e)},selected:-1!==d.indexOf(e.id),disabled:!e.availability,children:e.number},e.id)}))})]})]})}function he(e){var t=e.className,c=e.style,r=Object(p.b)(),a=Object(p.c)(se),s=Object(p.c)(ae),i=Object(p.c)(ie),l=Object(p.c)(le);Object(n.useEffect)((function(){!l&&s&&(r(V()),r(ee(s.id))),s||r(L({message:"Please login to view tickets"}))}),[s,r]);var o=j()("grid gap-4 grid-cols-1 lg:grid-cols-3 md:grid-cols-2",t);return Object(b.jsxs)("div",{className:o,style:c,children:["loading"===i&&Object(b.jsx)("div",{children:"loading..."}),"idle"===i&&s&&!a.length&&Object(b.jsx)("div",{children:"No ticket available"}),"idle"===i&&a.map((function(e){return Object(b.jsx)(h,{elevation:2,imageUrl:e.movie.poster,children:Object(b.jsxs)("div",{className:"flex flex-col p-2 w-full",children:[Object(b.jsx)("div",{className:"font-bold text-lg",children:e.movie.title}),Object(b.jsx)("div",{className:"text-gray-700 text-lg",children:e.slot.date}),Object(b.jsx)("div",{className:"mb-5 text-gray-700 text-lg",children:e.slot.startTime}),Object(b.jsxs)("div",{className:"text-right font-bold text-xl text-blue-700",children:["Hall ",e.slot.hall," Seat ",e.seat.number]})]})},e.id)}))]})}function Oe(e){var t=Object(p.c)(G),c=Object(p.b)(),n=j()("flex justify-center items-center","rounded","bg-red-100","p-3","text-red-500","my-2");return Object(b.jsx)(b.Fragment,{children:t&&Object(b.jsxs)("div",{className:n,children:[Object(b.jsx)("span",{className:"flex-grow",children:t.message}),Object(b.jsx)("button",{className:"rounded-full h-6 w-6 bg-white flex justify-center items-center font-bold text-xl",onClick:function(){c(V())},children:Object(b.jsx)("span",{children:"\xd7"})})]})})}var pe=function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("span",{className:"font-bold text-3xl text-blue-700",children:"OCB"}),Object(b.jsx)("span",{className:"text-3xl text-blue-500",children:"Cinema"})]})};var ge=function(){return Object(b.jsxs)("div",{className:"bg-gray-100 h-screen",children:[Object(b.jsxs)(v,{elevation:3,children:[Object(b.jsx)("div",{className:"flex-grow",children:Object(b.jsx)(i.b,{to:"/",children:Object(b.jsx)(pe,{})})}),Object(b.jsx)(je,{})]}),Object(b.jsxs)("div",{className:"p-3",children:[Object(b.jsx)(Oe,{}),Object(b.jsxs)(l.c,{children:[Object(b.jsx)(l.a,{path:"/movie/:movieId",children:Object(b.jsx)(xe,{})}),Object(b.jsx)(l.a,{path:"/tickets",children:Object(b.jsx)(he,{})}),Object(b.jsx)(l.a,{path:"/",children:Object(b.jsx)(q,{})})]})]})]})},ye=Object(k.a)({reducer:{user:oe,movieService:J,noticeService:$}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(p.a,{store:ye,children:Object(b.jsx)(i.a,{children:Object(b.jsx)(ge,{})})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[48,1,2]]]);
//# sourceMappingURL=main.6d78deeb.chunk.js.map