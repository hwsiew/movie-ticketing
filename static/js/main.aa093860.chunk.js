(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{11:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return o})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return u}));var c=n(10),r=Object(c.c)({name:"noticeService",initialState:{error:null,warning:null,info:null},reducers:{error:function(e,t){e.error=t.payload},dismissError:function(e){e.error=null},info:function(e,t){e.info=t.payload},dismissInfo:function(e,t){e.info=null}}}),a=r.actions,s=a.error,i=a.dismissError,l=a.info,o=a.dismissInfo,d=function(e){return e.noticeService.error},u=function(e){return e.noticeService.info};t.a=r.reducer},29:function(e,t,n){e.exports={available:"Seat_available__gMd6U",selected:"Seat_selected__3tu3N"}},36:function(e,t,n){},49:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(23),s=n.n(a),i=(n(36),n(17)),l=n(2),o=n(8),d=n(24),u=n(4),j=n.n(u),b=n(0);function f(e){var t=e.style,n=e.className,c=e.children,r=e.elevation,a=void 0===r?1:r,s=e.onClick,i=j()("paper-default",n,{"shadow-sm":1===a,shadow:2===a,"shadow-md":3===a,"shadow-lg":4===a,"shadow-xl":5===a,"shadow-2xl":6===a});return Object(b.jsx)("div",{style:t,className:i,onClick:s,children:c})}var v=["children","className","style"];function m(e){var t=e.children,n=e.className,c=e.style,r=Object(d.a)(e,v),a=j()("appBar-default",n);return Object(b.jsx)(f,Object(o.a)(Object(o.a)({style:c,className:a},r),{},{children:t}))}var h=["className","style","imageUrl","children"];function O(e){var t=e.className,n=e.style,c=e.imageUrl,r=e.children,a=Object(d.a)(e,h),s=j()(t);return Object(b.jsxs)(f,Object(o.a)(Object(o.a)({className:s,style:n},a),{},{children:[c&&Object(b.jsx)("div",{className:"h-full w-48 flex-none bg-cover rounded-t lg:rounded-t-none lg:rounded-l text-center overflow-hidden",style:{backgroundImage:"url('".concat(c,"')")}}),r]}))}function x(e){var t=e.className,n=e.style,c=e.movie,r=j()("movieCard-default",t),a=Object(l.f)();return Object(b.jsx)(O,{className:r,style:n,onClick:function(e){a.push("/movie/".concat(c.id))},imageUrl:c.poster,children:Object(b.jsxs)("div",{className:"flex flex-col justify-between p-2 h-full",children:[Object(b.jsxs)("div",{className:"flex flex-col",children:[Object(b.jsx)("div",{className:"text-gray-900 font-bold text-xl mb-2",children:c.title}),Object(b.jsx)("p",{className:"text-gray-700 text-lg text-base",children:c.description}),Object(b.jsxs)("p",{className:"text-gray-500 text-sm text-base",children:["Cast: ",c.cast]}),Object(b.jsxs)("p",{className:"text-gray-500 text-sm text-base",children:["Director: ",c.director]})]}),Object(b.jsxs)("div",{className:"text-right",children:[" ",c.runtime," mins "]})]})})}var p=n(3),g=n(20),y=n(5),N=n.n(y),w=n(12),k=n(10),S="development"===Object({NODE_ENV:"production",PUBLIC_URL:"/movie-ticketing",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_ENV?{protocol:"http",host:"localhost:8080"}:{protocol:"https",host:"murmuring-wildwood-07967.herokuapp.com"},C=Object(o.a)({},Object(o.a)(Object(o.a)({},{path:"/api/v1"}),S));function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.startsWith("/")&&(e=e.slice(1));var n="".concat(C.protocol,"://").concat(C.host).concat(C.path),c="".concat(n,"/").concat(e);return fetch(c,t).then(function(){var e=Object(w.a)(N.a.mark((function e(t){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=4;break}return e.abrupt("return",t.json());case 4:return e.next=6,t.json();case 6:return n=e.sent,e.abrupt("return",Promise.reject(n.message));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){return e}))}function T(){return E.apply(this,arguments)}function E(){return(E=Object(w.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"movie/all",e.abrupt("return",I("movie/all"));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){return I("movie/".concat(e))}function P(e,t,n,c){return I("movie/".concat(e,"/slot/").concat(t,"/").concat(n),{method:"POST",body:JSON.stringify(c),headers:{"Content-Type":"application/json"}})}function A(e){return I("ticket/".concat(e))}var D=Object(k.b)("movieService/fetchMovies",Object(w.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T();case 3:return t=e.sent,e.abrupt("return",t);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))),R=Object(k.b)("movieService/fetchMovie",function(){var e=Object(w.a)(N.a.mark((function e(t,n){var c,r,a,s,i;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=t.movieId,r=t.refresh,a=void 0!==r&&r,s=n.getState,e.prev=2,M(c)(s())&&!a){e.next=11;break}return e.next=7,_(c);case 7:return i=e.sent,e.abrupt("return",i);case 11:return e.abrupt("return",null);case 12:e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(2),e.abrupt("return",Promise.reject(e.t0));case 17:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t,n){return e.apply(this,arguments)}}()),U=Object(k.c)({name:"movieService",initialState:{movies:[],status:"idle"},reducers:{updateSeatAvailability:function(e,t){var n,c=t.payload,r=Object(g.a)(c);try{var a=function(){var t=n.value;e.movies.find((function(e){return e.id===t.movie.id})).slots.find((function(e){return e.id===t.slot.id})).seats.find((function(e){return e.id===t.seat.id})).availability=t.seat.availability};for(r.s();!(n=r.n()).done;)a()}catch(s){r.e(s)}finally{r.f()}}},extraReducers:function(e){e.addCase(D.pending,(function(e){e.status="loading"})).addCase(D.fulfilled,(function(e,t){e.status="idle",e.movies=t.payload})).addCase(D.rejected,(function(e,t){e.status="idle"})).addCase(R.pending,(function(e){e.status="loading"})).addCase(R.fulfilled,(function(e,t){if(e.status="idle",t.payload){var n=t.payload,c=e.movies.findIndex((function(e){return e.id===n.id}));-1===c?e.movies.push(t.payload):(e.movies.splice(c,1),e.movies.push(n))}})).addCase(R.rejected,(function(e,t){e.status="idle"}))}}),W=U.actions.updateSeatAvailability,B=function(e){return e.movieService.movies},M=function(e){return function(t){return t.movieService.movies.find((function(t){return t.id===e}))}},J=function(e){return e.movieService.status},F=U.reducer,H=n(11);function K(e){var t=e.className,n=e.style,r=Object(p.c)(B),a=Object(p.c)(J),s=Object(p.b)(),i=j()("grid gap-4 grid-cols-1 lg:grid-cols-2",t);return Object(c.useEffect)((function(){s(D()).unwrap().then((function(e){e.length||s(Object(H.e)({message:"Server is starting up. Please refresh the page..."}))})).catch((function(e){s(Object(H.d)(e))}))}),[s]),Object(b.jsxs)("div",{className:i,style:n,children:["loading"===a&&Object(b.jsx)("div",{children:"loading..."}),"loading"!==a&&r.map((function(e){return Object(b.jsx)(x,{movie:e},e.id)}))]})}var L=n(14),V=(n(48),n(22)),z=sessionStorage.getItem("user"),G={details:z?JSON.parse(z):null,tickets:[],status:"idle",loaded:!1},$=Object(k.b)("userService/bookTickets",function(){var e=Object(w.a)(N.a.mark((function e(t,n){var c,r,a,s,i;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.movieId,r=t.slotId,a=t.userId,s=t.seatIds,n.dispatch,e.prev=2,e.next=5,P(c,r,a,s);case 5:return i=e.sent,e.abrupt("return",i);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",Promise.reject(e.t0));case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,n){return e.apply(this,arguments)}}()),q=Object(k.b)("userService/getTickets",function(){var e=Object(w.a)(N.a.mark((function e(t,n){var c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.dispatch,e.prev=1,e.next=4,A(t);case 4:return c=e.sent,e.abrupt("return",c);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",Promise.reject(e.t0));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}()),Q=Object(k.c)({name:"userService",initialState:G,reducers:{signIn:function(e){var t={id:"abc"};sessionStorage.setItem("user",JSON.stringify(t)),e.details=t},signOut:function(e){sessionStorage.clear(),e.details=null},addTickets:function(e,t){var n,c=t.payload,r=Object(g.a)(c);try{for(r.s();!(n=r.n()).done;){var a=n.value;e.tickets.push(a)}}catch(s){r.e(s)}finally{r.f()}}},extraReducers:function(e){e.addCase($.pending,(function(e){e.status="loading"})).addCase($.fulfilled,(function(e,t){var n;e.status="idle",(n=e.tickets).push.apply(n,Object(V.a)(t.payload))})).addCase($.rejected,(function(e,t){e.status="idle"})).addCase(q.pending,(function(e){e.status="loading"})).addCase(q.fulfilled,(function(e,t){e.status="idle",e.loaded=!0;var n,c=t.payload,r=Object(g.a)(c);try{var a=function(){var t=n.value;e.tickets.find((function(e){return e.id===t.id}))||e.tickets.push(t)};for(r.s();!(n=r.n()).done;)a()}catch(s){r.e(s)}finally{r.f()}}))}}),X=Q.actions,Y=X.signIn,Z=X.signOut,ee=(X.addTickets,function(e){return e.user.details}),te=function(e){return e.user.tickets},ne=function(e){return e.user.status},ce=function(e){return e.user.loaded},re=Q.reducer,ae=function(){var e=Object(l.g)().pathname,t=Object(l.f)(),n=Object(p.b)(),r=Object(c.useState)(!1),a=Object(L.a)(r,2),s=a[0],i=a[1],o=j()("absolute w-40 bg-white right-0 shadow-md p-2 group-hover:block",{hidden:!s});return Object(b.jsxs)("div",{className:"group relative",children:[Object(b.jsxs)("button",{className:"flex items-center",onClick:function(){i(!s)},children:[Object(b.jsx)("span",{className:"hidden md:inline-block",children:" Welcome back! "}),Object(b.jsx)("div",{className:"rounded-full h-10 w-10 flex items-center justify-center bg-blue-200 ml-2",children:Object(b.jsx)("box-icon",{name:"user",color:"white"})})]}),Object(b.jsxs)("ul",{className:o,children:[Object(b.jsx)("li",{className:"px-3 py-2",children:Object(b.jsxs)("button",{className:"flex items-center justify-between",onClick:function(){t.push("/tickets")},children:[Object(b.jsx)("box-icon",{name:"barcode"}),Object(b.jsx)("span",{className:"ml-2",children:"My Tickets"})]})}),Object(b.jsx)("li",{className:"px-3 py-2 hower:bg-gray-100",children:Object(b.jsxs)("button",{className:"flex items-center justify-between ",onClick:function(){n(Z()),"/tickets"===e&&t.push("/")},children:[Object(b.jsx)("box-icon",{name:"log-out"}),Object(b.jsx)("span",{className:"ml-2 flex-grow",children:"Sign Out"})]})})]})]})},se=function(){var e=Object(p.b)();return Object(b.jsx)("button",{className:"flex items-center",onClick:function(){e(Y())},children:Object(b.jsx)("box-icon",{name:"log-in"})})};function ie(e){var t=e.className,n=e.style,c=Object(p.c)(ee),r=j()(t);return Object(b.jsx)("div",{className:r,style:n,children:c?Object(b.jsx)(ae,{}):Object(b.jsx)(se,{})})}var le=n(18),oe=n(29),de=n.n(oe);function ue(e){var t,n=e.children,c=e.selected,r=e.disabled,a=e.onToggle,s=j()("h-12 md:h-16 lg:h-24 flex justify-center items-center rounded-md",r?"bg-gray-300 cursor-default":"bg-white cursor-pointer",(t={},Object(le.a)(t,de.a.selected,c&&!r),Object(le.a)(t,de.a.available,!c),t));return Object(b.jsx)("div",{className:s,onClick:function(e){return r?e.stopPropagation:a(e)},children:n})}function je(e){var t=Object(l.h)().movieId,n=Object(p.b)(),r=Object(p.c)(ee),a=Object(p.c)(M(t)),s=Object(p.c)(J),i=Object(p.c)(ne),o=Object(c.useState)([]),d=Object(L.a)(o,2),u=d[0],v=d[1],m=Object(c.useState)(""),h=Object(L.a)(m,2),O=h[0],g=h[1],y=Object(c.useState)(""),N=Object(L.a)(y,2),w=N[0],k=N[1],S=Object(c.useState)([]),C=Object(L.a)(S,2),I=C[0],T=C[1],E=Object(c.useState)([]),_=Object(L.a)(E,2),P=_[0],A=_[1],D=Object(c.useState)(0),U=Object(L.a)(D,2),B=U[0],F=U[1],K=a?a.slots.reduce((function(e,t){var n=t.date;return n in e||(e[n]={}),e[n][t.endTime]=t,e}),{}):{};Object(c.useEffect)((function(){n(R({movieId:t})).unwrap().catch((function(e){return n(Object(H.d)(e))}));var e=Object.keys(K);if(e.length){var c=e[0];g(c);var r=K[c],s=Object.keys(r).map((function(e){return{id:r[e].id,time:e}}));if(T(s),s.length){var i=s[0].id;k(i);var l=a.slots.find((function(e){return e.id===i})).seats;A(l)}}}),[a]);var z=j()("mt-3 border rounded  text-white p-2 text-lg font-medium",u.length&&r&&"loading"!==i?"bg-green-400":"bg-gray-300"),G=j()("text-right text-blue-500",{hidden:r}),q=j()("text-md","font-medium");return Object(b.jsxs)("div",{children:[!a&&"loading"===s&&Object(b.jsx)("div",{children:" loading... "}),a&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"flex",children:[Object(b.jsx)(x,{className:"hidden md:flex flex-grow",movie:a}),Object(b.jsxs)(f,{className:"flex-col p-5 md:w-96 w-full",elevation:1,children:[Object(b.jsx)("div",{className:"w-full mb-2",children:Object(b.jsx)("span",{className:"text-gray-900 font-bold text-xl",children:a.title})}),Object(b.jsxs)("div",{className:"flex flex-col w-full mb-2",children:[Object(b.jsx)("span",{className:q,children:"DATE:"}),Object(b.jsxs)("select",{onChange:function(e){return g(e.target.value)},value:O,children:[Object(b.jsx)("option",{value:"",disabled:!0,children:"select a date"}),Object.keys(K).map((function(e){return Object(b.jsx)("option",{value:e,children:e},e)}))]})]}),Object(b.jsxs)("div",{className:"flex flex-col w-full mb-2",children:[Object(b.jsx)("span",{className:q,children:"TIME:"}),Object(b.jsxs)("select",{onChange:function(e){return k(e.target.value)},value:w,children:[Object(b.jsx)("option",{value:"",disabled:!0,children:"select a time"}),I.map((function(e){return Object(b.jsx)("option",{value:e.id,children:e.time},e.id)}))]})]}),Object(b.jsxs)("div",{className:"flex flex-row w-full mb-2 justify-between",children:[Object(b.jsxs)("div",{className:q,children:[" ",u.length," tickets"]}),Object(b.jsxs)("div",{className:q,children:[" SGD ",B]})]}),Object(b.jsxs)("div",{className:"flex flex-col w-full",children:[Object(b.jsx)("button",{className:z,onClick:function(){var e={movieId:t,slotId:w,userId:r.id,seatIds:u};n($(e)).unwrap().then((function(e){n(W(e)),alert("Ticket successfully booked!")})).catch((function(e){n(Object(H.d)(e)),n(R({movieId:t,refresh:!0}))})).finally((function(){v([]),F(0)}))},disabled:!u.length||!r||"loading"===i,children:"Book Now"}),Object(b.jsx)("div",{className:G,children:"Please login to proceed."})]})]})]}),Object(b.jsx)("div",{className:"flex justify-center border my-2 bg-white",children:" screen"}),Object(b.jsx)("div",{className:"grid grid-cols-8 gap-1 md:gap-2 lg:gap-4",children:P.map((function(e){return Object(b.jsx)(ue,{onToggle:function(t){return function(e,t){var n=t.id,c=u.indexOf(n);-1===c?(v([].concat(Object(V.a)(u),[n])),F(B+t.price)):(u.splice(c,1),v(Object(V.a)(u)),F(B-t.price))}(0,e)},selected:-1!==u.indexOf(e.id),disabled:!e.availability,children:e.number},e.id)}))})]})]})}function be(e){var t=e.className,n=e.style,r=Object(p.b)(),a=Object(p.c)(te),s=Object(p.c)(ee),i=Object(p.c)(ne),l=Object(p.c)(ce);Object(c.useEffect)((function(){!l&&s&&(r(Object(H.b)()),r(q(s.id))),s||r(Object(H.d)({message:"Please login to view tickets"}))}),[s,r]);var o=j()("grid gap-4 grid-cols-1 lg:grid-cols-3 md:grid-cols-2",t);return Object(b.jsxs)("div",{className:o,style:n,children:["loading"===i&&Object(b.jsx)("div",{children:"loading..."}),"idle"===i&&s&&!a.length&&Object(b.jsx)("div",{children:"No ticket available"}),"idle"===i&&a.map((function(e){return Object(b.jsx)(O,{elevation:2,imageUrl:e.movie.poster,children:Object(b.jsxs)("div",{className:"flex flex-col p-2 w-full",children:[Object(b.jsx)("div",{className:"font-bold text-lg",children:e.movie.title}),Object(b.jsx)("div",{className:"text-gray-700 text-lg",children:e.slot.date}),Object(b.jsx)("div",{className:"mb-5 text-gray-700 text-lg",children:e.slot.startTime}),Object(b.jsxs)("div",{className:"text-right font-bold text-xl text-blue-700",children:["Hall ",e.slot.hall," Seat ",e.seat.number]})]})},e.id)}))]})}var fe=r.a.lazy((function(){return n.e(3).then(n.bind(null,50))})),ve=function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("span",{className:"font-bold text-3xl text-blue-700",children:"OCB"}),Object(b.jsx)("span",{className:"text-3xl text-blue-500",children:"Cinema"})]})};var me=function(){return Object(b.jsxs)("div",{className:"bg-gray-100 h-screen",children:[Object(b.jsxs)(m,{elevation:3,children:[Object(b.jsx)("div",{className:"flex-grow",children:Object(b.jsx)(i.b,{to:"/",children:Object(b.jsx)(ve,{})})}),Object(b.jsx)(ie,{})]}),Object(b.jsxs)("div",{className:"p-3",children:[Object(b.jsx)(c.Suspense,{fallback:Object(b.jsx)("div",{}),children:Object(b.jsx)(fe,{})}),Object(b.jsxs)(l.c,{children:[Object(b.jsx)(l.a,{path:"/movie/:movieId",children:Object(b.jsx)(je,{})}),Object(b.jsx)(l.a,{path:"/tickets",children:Object(b.jsx)(be,{})}),Object(b.jsx)(l.a,{path:"/",children:Object(b.jsx)(K,{})})]})]})]})},he=Object(k.a)({reducer:{user:re,movieService:F,noticeService:H.a}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(p.a,{store:he,children:Object(b.jsx)(i.a,{children:Object(b.jsx)(me,{})})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[49,1,2]]]);
//# sourceMappingURL=main.aa093860.chunk.js.map